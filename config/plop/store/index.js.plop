import { graphql } from "react-apollo";
import compose from "recompose/compose";
import { defaults } from "./defaults";
import * as queries from "./queries";
import * as mutations from "./mutations";
import * as resolvers from "./resolvers";

const {{camelCase storeName}}Store = {
  defaults,
  mutations: {
    ...resolvers
  }
};

const {{camelCase storeName}}QueryHandler = {
  props: ({ ownProps, data: { {{camelCase storeName}} = {} } }) => ({
    ...ownProps,
    {{camelCase storeName}}
  })
};

const handler = [graphql(queries["{{camelCase storeName}}Query"], {{camelCase storeName}}QueryHandler)];

const graphMutations = Object.keys(mutations).map(mutation =>
  graphql(mutations[mutation], { name: mutation })
);

const toCompose = handler.concat(graphMutations);

const with{{pascalCase storeName}}Store = compose(...toCompose);

export { {{camelCase storeName}}Store, mutations, queries, with{{pascalCase storeName}}Store };
